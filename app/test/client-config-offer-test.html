<!--
Copyright 2017 Next Century Corporation

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <title>client-config</title>
  <script src="../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../bower_components/web-component-tester/browser.js"></script>
  <script src="data/ad-data.js" type="text/javascript"></script>
  <script src="data/ad-bar-chart-data.js" type="text/javascript"></script>
  <link rel="import" href="../elements/client-config/client-config.html">
  <link rel="import" href="../elements/lodash.html">
</head>

<body>
<test-fixture id="client-config-fixture">
  <template>
    <client-config></client-config>
  </template>
</test-fixture>

<script>
  'use strict';
  /* globals _, suite, test, expect, setup, fixture, assert, AD_DATA, AD_BAR_CHART_DATA */
  /* jshint -W030 */
  suite('<client-config> offer tests', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with offer transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.offer).to.be.a('Function');
    });

    test('defines offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.equal(output.id, 'FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965');
      assert.equal(output.url, 'http://google.com/abc123');
      assert.equal(output.rank, 1.23);
      assert.equal(output.domain, 'google.com');
      assert.equal(output.type, 'offer');
      assert.equal(output.icon, 'maps:local-offer');
      assert.equal(output.link, '/offer.html?id=FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965');
      assert.equal(output.styleClass, 'entity-offer-font');
      assert.equal(output.title, 'Test Ad');
      assert.equal(output.description, 'The quick brown fox jumped over the lazy dog.');
      assert.isUndefined(output.highlightedText);
    });

    test('defines date in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.date, {
        icon: 'icons:date-range',
        styleClass: 'entity-date-font',
        text: 'Feb 6, 2017',
        type: 'date'
      });
    });

    test('defines publisher in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.publishers, [{
        count: undefined,
        id: 'google.com',
        icon: 'av:web',
        styleClass: 'entity-webpage-font',
        text: 'google.com',
        type: 'webpage'
      }]);
    });

    test('defines location array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.locations, [{
        confidence: 'strict',
        count: undefined,
        id: 'Roanoke:Virginia:United States:-79.94143:37.27097',
        icon: 'communication:location-on',
        latitude: '37.27097',
        longitude: '-79.94143',
        link: '/location.html?id=Roanoke:Virginia:United States:-79.94143:37.27097',
        styleClass: 'entity-location-font',
        text: 'Roanoke, Virginia',
        textAndCount: 'Roanoke, Virginia',
        textAndCountry: 'Roanoke, Virginia, United States',
        type: 'location'
      }, {
        confidence: 'strict',
        count: undefined,
        id: 'Atlanta:Georgia:United States:-84.38798:33.749',
        icon: 'communication:location-on',
        latitude: '33.749',
        longitude: '-84.38798',
        link: '/location.html?id=Atlanta:Georgia:United States:-84.38798:33.749',
        styleClass: 'entity-location-font',
        text: 'Atlanta, Georgia',
        textAndCount: 'Atlanta, Georgia',
        textAndCountry: 'Atlanta, Georgia, United States',
        type: 'location'
      }, {
        confidence: 'strict',
        count: undefined,
        id: 'Brooklyn:New York:United States:-73.94958:40.6501',
        icon: 'communication:location-on',
        latitude: '40.6501',
        longitude: '-73.94958',
        link: '/location.html?id=Brooklyn:New York:United States:-73.94958:40.6501',
        styleClass: 'entity-location-font',
        text: 'Brooklyn, New York',
        textAndCount: 'Brooklyn, New York',
        textAndCountry: 'Brooklyn, New York, United States',
        type: 'location'
      }, {
        confidence: 'strict',
        count: undefined,
        id: 'Houston:Texas:United States:-95.36327:29.76328',
        icon: 'communication:location-on',
        latitude: '29.76328',
        longitude: '-95.36327',
        link: '/location.html?id=Houston:Texas:United States:-95.36327:29.76328',
        styleClass: 'entity-location-font',
        text: 'Houston, Texas',
        textAndCount: 'Houston, Texas',
        textAndCountry: 'Houston, Texas, United States',
        type: 'location'
        /*
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: 'Columbus:Ohio:United States:-82.99879:39.96118',
        icon: 'communication:location-on',
        latitude: '39.96118',
        longitude: '-82.99879',
        link: '/location.html?id=Columbus:Ohio:United States:-82.99879:39.96118',
        styleClass: 'entity-location-font',
        text: 'Columbus, Ohio',
        textAndCount: 'Columbus, Ohio',
        textAndCountry: 'Columbus, Ohio, United States',
        type: 'location'
        */
      }]);
    });

    test('defines phone array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.phones, [{
        confidence: 'strict',
        count: undefined,
        id: '+1-1234567890',
        link: '/phone.html?id=+1-1234567890',
        icon: 'communication:phone',
        styleClass: 'entity-phone-font',
        text: '123-456-7890',
        type: 'phone'
        /*
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: '1112223333',
        link: '/phone.html?id=1112223333',
        icon: 'communication:phone',
        styleClass: 'entity-phone-font',
        text: '111-222-3333',
        type: 'phone'
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: '+1-9999999999',
        link: '/phone.html?id=+1-9999999999',
        icon: 'communication:phone',
        styleClass: 'entity-phone-font',
        text: '999-999-9999',
        type: 'phone'
        */
      }]);
    });

    test('defines email array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.emails, [{
        confidence: 'strict',
        count: undefined,
        id: 'test@gmail.com',
        link: '/email.html?id=test%40gmail.com',
        icon: 'communication:email',
        styleClass: 'entity-email-font',
        text: 'test@gmail.com',
        type: 'email'
        /*
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: 'test@yahoo.com',
        link: '/email.html?id=test%40yahoo.com',
        icon: 'communication:email',
        styleClass: 'entity-email-font',
        text: 'test@yahoo.com',
        type: 'email'
        */
      }]);
    });

    test('defines webpage array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.webpages, [{
        icon: 'av:web',
        link: 'http://google.com/abc123',
        styleClass: 'entity-webpage-font',
        text: 'http://google.com/abc123',
        type: 'webpage'
      }]);
    });

    test('defines cache array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.caches, [{
        icon: 'icons:cached',
        link: '/cache.html?id=FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965',
        styleClass: 'entity-cache-font',
        text: 'Open Cached Webpage',
        type: 'cache'
      }]);
    });

    test('defines review IDs array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.reviewIds, [{
        confidence: 'strict',
        count: undefined,
        id: '123456',
        icon: 'icons:thumbs-up-down',
        styleClass: 'entity-review-font',
        text: '123456',
        type: 'review'
      }]);
    });

    test('defines social media IDs array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.socialIds, [{
        confidence: 'strict',
        count: undefined,
        id: 'username',
        icon: 'social:public',
        styleClass: 'entity-social-font',
        text: 'twitter username',
        type: 'social'
      }]);
    });

    test('defines services array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.services, [{
        confidence: 'strict',
        count: undefined,
        id: 'massage',
        icon: 'icons:work',
        styleClass: 'entity-service-font',
        text: 'massage',
        type: 'service'
        /*
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: 'deep tissue',
        icon: 'icons:work',
        styleClass: 'entity-service-font',
        text: 'deep tissue',
        type: 'service'
        */
      }]);
    });

    test('defines price array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.prices, [{
        confidence: 'strict',
        count: undefined,
        id: '180-per-60min',
        icon: 'editor:attach-money',
        styleClass: 'entity-money-font',
        text: '180',
        type: 'money'
      }, {
        confidence: 'strict',
        count: undefined,
        id: '120-per-30min',
        icon: 'editor:attach-money',
        styleClass: 'entity-money-font',
        text: '120',
        type: 'money'
        /*
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: '75-per-15min',
        icon: 'editor:attach-money',
        styleClass: 'entity-provider-font',
        text: '75',
        type: 'provider'
        */
      }]);
    });

    test('defines name array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.names, [{
        confidence: 'strict',
        count: undefined,
        id: 'bianca',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'bianca',
        type: 'provider'
        /*
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: 'sweet',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'sweet',
        type: 'provider'
        */
      }]);
    });

    test('defines age array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.ages, [{
        confidence: 'strict',
        count: undefined,
        id: '24',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: '24',
        type: 'provider'
        /*
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: '35',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: '35',
        type: 'provider'
        */
      }]);
    });

    test('defines ethnicity array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.ethnicities, [{
        confidence: 'strict',
        count: undefined,
        id: 'hispanic',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'hispanic',
        type: 'provider'
        /*
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: 'asian',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'asian',
        type: 'provider'
        */
      }]);
    });

    test('defines gender array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.genders, [{
        confidence: 'strict',
        count: undefined,
        id: 'female',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'female',
        type: 'provider'
      }]);
    });

    test('defines eye color array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.eyeColors, [{
        confidence: 'strict',
        count: undefined,
        id: 'brown',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'brown',
        type: 'provider'
        /*
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: 'black',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'black',
        type: 'provider'
        */
      }]);
    });

    test('defines hair color array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.hairColors, [{
        confidence: 'strict',
        count: undefined,
        id: 'black',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'black',
        type: 'provider'
      }]);
    });

    test('defines height array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.heights, [{
        confidence: 'strict',
        count: undefined,
        id: '157',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: '157',
        type: 'provider'
        /*
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: '155',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: '155',
        type: 'provider'
        */
      }]);
    });

    test('defines weight array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.weights, [{
        confidence: 'strict',
        count: undefined,
        id: '60',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: '60',
        type: 'provider'
        /*
      }, {
        confidence: 'relaxed',
        count: undefined,
        id: '78',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: '78',
        type: 'provider'
        */
      }]);
    });

    test('defines detail array in offer', function() {
      var output = clientConfig.config.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.details, [{
        name: 'Url',
        link: 'http://google.com/abc123',
        text: 'http://google.com/abc123'
      }, {
        highlightedText: undefined,
        name: 'Description',
        text: 'The quick brown fox jumped over the lazy dog.'
      }, {
        name: 'Cached Webpage',
        link: '/cache.html?id=FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965',
        text: 'Open'
      }]);
    });
  });

  suite('<client-config> offer tests with highlights', function() {
    var clientConfig;
    var data;
    var output;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      data = _.cloneDeep(AD_DATA);
      data.hits.hits[0].highlight = {
        'fields.title.strict.name': ['<em>Test</em> Ad'],
        'fields.description.strict.name': ['The <em>quick brown</em> fox jumped over the <em>lazy</em> dog.'],
        'fields.city.strict.name': ['<em>Roanoke</em>', '<em>Atlanta</em>'],
        'fields.state.strict.name': ['<em>Texas</em>'],
        'fields.phone.strict.name': ['<em>+1-1234567890</em>'],
        'fields.email.strict.name': ['<em>test@gmail.com</em>'],
        'fields.review_id.strict.name': ['<em>123456</em>'],
        'fields.social_media_id.strict.name': ['twitter <em>username</em>'],
        'fields.service.strict.name': ['<em>massage</em>'],
        'fields.price.strict.name': ['<em>180</em>'],
        'fields.name.strict.name': ['<em>bianca</em>'],
        'fields.gender.strict.name': ['<em>female</em>'],
        'fields.age.strict.name': ['<em>24</em>'],
        'fields.ethnicity.strict.name': ['<em>hispanic</em>'],
        'fields.eye_color.strict.name': ['<em>brown</em>'],
        'fields.hair_color.strict.name': ['<em>black</em>'],
        'fields.height.strict.name': ['<em>157</em>'],
        'fields.weight.strict.name': ['<em>60</em>'],
        'tld': ['<em>google.com</em>']
      };
      output = clientConfig.config.transforms.offer.offer(data);
    });

    test('defines offer', function() {
      assert.equal(output.id, 'FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965');
      assert.equal(output.url, 'http://google.com/abc123');
      assert.equal(output.rank, 1.23);
      assert.equal(output.domain, 'google.com');
      assert.equal(output.type, 'offer');
      assert.equal(output.icon, 'maps:local-offer');
      assert.equal(output.link, '/offer.html?id=FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965');
      assert.equal(output.styleClass, 'entity-offer-font');
      assert.equal(output.title, 'Test Ad');
      assert.equal(output.description, 'The quick brown fox jumped over the lazy dog.');
      assert.equal(output.highlightedText, '<em>Test</em> Ad');
    });

    test('defines publisher in offer', function() {
      assert.deepEqual(output.publishers, [{
        count: undefined,
        highlight: true,
        id: 'google.com',
        icon: 'av:web',
        styleClass: 'entity-webpage-font',
        text: 'google.com',
        type: 'webpage'
      }]);
    });

    test('defines location array in offer', function() {
      assert.deepEqual(output.locations, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: 'Roanoke:Virginia:United States:-79.94143:37.27097',
        icon: 'communication:location-on',
        latitude: '37.27097',
        longitude: '-79.94143',
        link: '/location.html?id=Roanoke:Virginia:United States:-79.94143:37.27097',
        styleClass: 'entity-location-font',
        text: 'Roanoke, Virginia',
        textAndCount: 'Roanoke, Virginia',
        textAndCountry: 'Roanoke, Virginia, United States',
        type: 'location'
      }, {
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: 'Atlanta:Georgia:United States:-84.38798:33.749',
        icon: 'communication:location-on',
        latitude: '33.749',
        longitude: '-84.38798',
        link: '/location.html?id=Atlanta:Georgia:United States:-84.38798:33.749',
        styleClass: 'entity-location-font',
        text: 'Atlanta, Georgia',
        textAndCount: 'Atlanta, Georgia',
        textAndCountry: 'Atlanta, Georgia, United States',
        type: 'location'
      }, {
        confidence: 'strict',
        count: undefined,
        id: 'Brooklyn:New York:United States:-73.94958:40.6501',
        icon: 'communication:location-on',
        latitude: '40.6501',
        longitude: '-73.94958',
        link: '/location.html?id=Brooklyn:New York:United States:-73.94958:40.6501',
        styleClass: 'entity-location-font',
        text: 'Brooklyn, New York',
        textAndCount: 'Brooklyn, New York',
        textAndCountry: 'Brooklyn, New York, United States',
        type: 'location'
      }, {
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: 'Houston:Texas:United States:-95.36327:29.76328',
        icon: 'communication:location-on',
        latitude: '29.76328',
        longitude: '-95.36327',
        link: '/location.html?id=Houston:Texas:United States:-95.36327:29.76328',
        styleClass: 'entity-location-font',
        text: 'Houston, Texas',
        textAndCount: 'Houston, Texas',
        textAndCountry: 'Houston, Texas, United States',
        type: 'location'
      }]);
    });

    test('defines phone array in offer', function() {
      assert.deepEqual(output.phones, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: '+1-1234567890',
        link: '/phone.html?id=+1-1234567890',
        icon: 'communication:phone',
        styleClass: 'entity-phone-font',
        text: '123-456-7890',
        type: 'phone'
      }]);
    });

    test('defines email array in offer', function() {
      assert.deepEqual(output.emails, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: 'test@gmail.com',
        link: '/email.html?id=test%40gmail.com',
        icon: 'communication:email',
        styleClass: 'entity-email-font',
        text: 'test@gmail.com',
        type: 'email'
      }]);
    });

    test('defines review IDs array in offer', function() {
      assert.deepEqual(output.reviewIds, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: '123456',
        icon: 'icons:thumbs-up-down',
        styleClass: 'entity-review-font',
        text: '123456',
        type: 'review'
      }]);
    });

    test('defines social media IDs array in offer', function() {
      assert.isTrue(output.socialIds[0].highlight);
      assert.deepEqual(output.socialIds, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: 'username',
        icon: 'social:public',
        styleClass: 'entity-social-font',
        text: 'twitter username',
        type: 'social'
      }]);
    });

    test('defines services array in offer', function() {
      assert.deepEqual(output.services, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: 'massage',
        icon: 'icons:work',
        styleClass: 'entity-service-font',
        text: 'massage',
        type: 'service'
      }]);
    });

    test('defines price array in offer', function() {
      assert.deepEqual(output.prices, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: '180-per-60min',
        icon: 'editor:attach-money',
        styleClass: 'entity-money-font',
        text: '180',
        type: 'money'
      }, {
        confidence: 'strict',
        count: undefined,
        id: '120-per-30min',
        icon: 'editor:attach-money',
        styleClass: 'entity-money-font',
        text: '120',
        type: 'money'
      }]);
    });

    test('defines name array in offer', function() {
      assert.deepEqual(output.names, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: 'bianca',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'bianca',
        type: 'provider'
      }]);
    });

    test('defines age array in offer', function() {
      assert.deepEqual(output.ages, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: '24',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: '24',
        type: 'provider'
      }]);
    });

    test('defines ethnicity array in offer', function() {
      assert.deepEqual(output.ethnicities, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: 'hispanic',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'hispanic',
        type: 'provider'
      }]);
    });

    test('defines gender array in offer', function() {
      assert.deepEqual(output.genders, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: 'female',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'female',
        type: 'provider'
      }]);
    });

    test('defines eye color array in offer', function() {
      assert.deepEqual(output.eyeColors, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: 'brown',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'brown',
        type: 'provider'
      }]);
    });

    test('defines hair color array in offer', function() {
      assert.deepEqual(output.hairColors, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: 'black',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'black',
        type: 'provider'
      }]);
    });

    test('defines height array in offer', function() {
      assert.deepEqual(output.heights, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: '157',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: '157',
        type: 'provider'
      }]);
    });

    test('defines weight array in offer', function() {
      assert.deepEqual(output.weights, [{
        confidence: 'strict',
        count: undefined,
        highlight: true,
        id: '60',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: '60',
        type: 'provider'
      }]);
    });

    test('defines detail array in offer', function() {
      assert.deepEqual(output.details, [{
        name: 'Url',
        link: 'http://google.com/abc123',
        text: 'http://google.com/abc123'
      }, {
        highlightedText: 'The <em>quick brown</em> fox jumped over the <em>lazy</em> dog.',
        name: 'Description',
        text: 'The quick brown fox jumped over the lazy dog.'
      }, {
        name: 'Cached Webpage',
        link: '/cache.html?id=FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965',
        text: 'Open'
      }]);
    });
  });

  suite('<client-config> offer tests with highlights (edge cases)', function() {
    var clientConfig;
    var data;
    var output;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      data = _.cloneDeep(AD_DATA);
      data.hits.hits[0].highlight = {
        'fields.email.strict.name': ['<em>test</em>@gmail.com'],
        'tld': ['<em>google</em>.com']
      };
      output = clientConfig.config.transforms.offer.offer(data);
    });

    test('does not define highlight in publisher if partial match', function() {
      assert.deepEqual(output.publishers, [{
        count: undefined,
        id: 'google.com',
        icon: 'av:web',
        styleClass: 'entity-webpage-font',
        text: 'google.com',
        type: 'webpage'
      }]);
    });

    test('does not define highlight in email if partial match', function() {
      assert.deepEqual(output.emails, [{
        confidence: 'strict',
        count: undefined,
        id: 'test@gmail.com',
        link: '/email.html?id=test%40gmail.com',
        icon: 'communication:email',
        styleClass: 'entity-email-font',
        text: 'test@gmail.com',
        type: 'email'
      }]);
    });
  });

  suite('<client-config> offer tests if offer result does not have data', function() {
    var clientConfig;
    var output;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
      output = clientConfig.config.transforms.offer.offer({
        hits: {
          hits: [{
            _source: {
              doc_id: 'testId',
              tld: 'testDomain',
              url: 'testUrl'
            }
          }]
        }
      });
      /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */
    });

    test('defines offer', function() {
      assert.equal(output.id, 'testId');
      assert.equal(output.url, 'testUrl');
      assert.equal(output.domain, 'testDomain');
      assert.equal(output.type, 'offer');
      assert.equal(output.icon, 'maps:local-offer');
      assert.equal(output.link, '/offer.html?id=testId');
      assert.equal(output.styleClass, 'entity-offer-font');
      assert.equal(output.title, 'No Title');
      assert.equal(output.description, 'No Description');
      assert.deepEqual(output.locations, []);
      assert.deepEqual(output.phones, []);
      assert.deepEqual(output.emails, []);
      assert.deepEqual(output.services, []);
      assert.deepEqual(output.prices, []);
      assert.deepEqual(output.names, []);
      assert.deepEqual(output.ages, []);
      assert.deepEqual(output.ethnicities, []);
      assert.deepEqual(output.genders, []);
      assert.deepEqual(output.hairColors, []);
      assert.deepEqual(output.eyeColors, []);
      assert.deepEqual(output.heights, []);
      assert.deepEqual(output.weights, []);
    });

    test('defines date in offer', function() {
      assert.deepEqual(output.date, {
        icon: 'icons:date-range',
        styleClass: 'entity-date-font',
        text: 'No Date',
        type: 'date'
      });
    });

    test('defines publisher in offer', function() {
      assert.deepEqual(output.publishers, [{
        count: undefined,
        id: 'testDomain',
        icon: 'av:web',
        styleClass: 'entity-webpage-font',
        text: 'testDomain',
        type: 'webpage'
      }]);
    });

    test('defines webpage array in offer', function() {
      assert.deepEqual(output.webpages, [{
        icon: 'av:web',
        link: 'testUrl',
        styleClass: 'entity-webpage-font',
        text: 'testUrl',
        type: 'webpage'
      }]);
    });

    test('defines cache array in offer', function() {
      assert.deepEqual(output.caches, [{
        icon: 'icons:cached',
        link: '/cache.html?id=testId',
        styleClass: 'entity-cache-font',
        text: 'Open Cached Webpage',
        type: 'cache'
      }]);
    });

    test('defines detail array in offer', function() {
      assert.deepEqual(output.details, [{
        name: 'Url',
        link: 'testUrl',
        text: 'testUrl'
      }, {
        highlightedText: undefined,
        name: 'Description',
        text: 'No Description'
      }, {
        name: 'Cached Webpage',
        link: '/cache.html?id=testId',
        text: 'Open'
      }]);
    });
  });

  suite('<client-config> offer tests if no results from query', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines empty offer for empty data', function() {
      var output = clientConfig.config.transforms.offer.offer({
        hits: {
          hits: []
        }
      });
      assert.deepEqual(output, {});
    });

    test('defines empty offer for data with no id', function() {
      var output = clientConfig.config.transforms.offer.offer({
        hits: {
          hits: [{
            tld: 'google.com',
            url: 'http://google.com'
          }]
        }
      });
      assert.deepEqual(output, {});
    });

    test('defines empty offer for data with no tld', function() {
      var output = clientConfig.config.transforms.offer.offer({
        hits: {
          hits: [{
            id: '1',
            url: 'http://google.com'
          }]
        }
      });
      assert.deepEqual(output, {});
    });

    test('defines empty offer for data with no url', function() {
      var output = clientConfig.config.transforms.offer.offer({
        hits: {
          hits: [{
            id: '1',
            url: 'http://google.com'
          }]
        }
      });
      assert.deepEqual(output, {});
    });
  });

  suite('<client-config> offer tests for event drops timeline data', function() {
    var clientConfig;
    /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
    var data = {
      aggregations: {
        locations: {
          locations: {
            buckets: [{
              key: 'Brooklyn:New York:United States:-73.94958:40.6501',
              doc_count: 4,
              dates: {
                buckets: [{
                  key: 1444608000000,
                  doc_count: 1
                }, {
                  key: 1444521600000,
                  doc_count: 2
                }, {
                  key: 1444435200000,
                  doc_count: 1
                }]
              }
            }, {
              key: 'Mumbai:State of Maharashtra:India:72.88261:19.07283',
              doc_count: 2,
              dates: {
                buckets: [{
                  key: 1444608000000,
                  doc_count: 2
                }]
              }
            }]
          }
        }
      }
    };
    /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with createEventDropsTimeline transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.createEventDropsTimeline).to.be.a('Function');
    });

    test('drops timeline function given empty input returns empty output', function() {
      var output = clientConfig.config.transforms.offer.createEventDropsTimeline({
        aggregations: {
          locations: {
            locations: {
              buckets: []
            }
          }
        }
      });
      expect(output).to.deep.equal({
        dates: [],
        locations: [],
        allLocations: [],
        otherLocations: []
      });
    });

    test('drops timeline function given aggregations returns correct data', function() {
      var output = clientConfig.config.transforms.offer.createEventDropsTimeline(data);

      expect(output.locations.length).to.equal(2);
      expect(output.locations[0].count).to.equal(4);
      expect(output.locations[0].id).to.equal('Brooklyn:New York:United States:-73.94958:40.6501');
      expect(output.locations[0].latitude).to.equal('40.6501');
      expect(output.locations[0].longitude).to.equal('-73.94958');
      expect(output.locations[0].icon).to.equal('communication:location-on');
      expect(output.locations[0].link).to.equal('/location.html?id=Brooklyn:New York:United States:-73.94958:40.6501');
      expect(output.locations[0].name).to.equal('Brooklyn, New York');
      expect(output.locations[0].styleClass).to.equal('entity-location-font');
      expect(output.locations[0].text).to.equal('Brooklyn, New York');
      expect(output.locations[0].textAndCount).to.equal('Brooklyn, New York (4)');
      expect(output.locations[0].textAndCountry).to.equal('Brooklyn, New York, United States');
      expect(output.locations[0].type).to.equal('location');
      expect(output.locations[0].dates).to.be.an('Array');
      expect(output.locations[0].dates.length).to.equal(3);
      expect(output.locations[0].dates[0].date).to.be.a('Date');
      expect(output.locations[0].dates[0].date.getTime()).to.equal(1444435200000);
      expect(output.locations[0].dates[0].count).to.equal(1);
      expect(output.locations[0].dates[0].name).to.equal('Brooklyn, New York');
      expect(output.locations[0].dates[1].date).to.be.a('Date');
      expect(output.locations[0].dates[1].date.getTime()).to.equal(1444521600000);
      expect(output.locations[0].dates[1].count).to.equal(2);
      expect(output.locations[0].dates[1].name).to.equal('Brooklyn, New York');
      expect(output.locations[0].dates[2].date).to.be.a('Date');
      expect(output.locations[0].dates[2].date.getTime()).to.equal(1444608000000);
      expect(output.locations[0].dates[2].count).to.equal(1);
      expect(output.locations[0].dates[2].name).to.equal('Brooklyn, New York');

      expect(output.locations[1].count).to.equal(2);
      expect(output.locations[1].id).to.equal('Mumbai:State of Maharashtra:India:72.88261:19.07283');
      expect(output.locations[1].latitude).to.equal('19.07283');
      expect(output.locations[1].longitude).to.equal('72.88261');
      expect(output.locations[1].icon).to.equal('communication:location-on');
      expect(output.locations[1].link).to.equal('/location.html?id=Mumbai:State of Maharashtra:India:72.88261:19.07283');
      expect(output.locations[1].name).to.equal('Mumbai, State of Maharashtra');
      expect(output.locations[1].styleClass).to.equal('entity-location-font');
      expect(output.locations[1].text).to.equal('Mumbai, State of Maharashtra');
      expect(output.locations[1].textAndCount).to.equal('Mumbai, State of Maharashtra (2)');
      expect(output.locations[1].textAndCountry).to.equal('Mumbai, State of Maharashtra, India');
      expect(output.locations[1].type).to.equal('location');
      expect(output.locations[1].dates).to.be.an('Array');
      expect(output.locations[1].dates.length).to.equal(1);
      expect(output.locations[1].dates[0].date).to.be.a('Date');
      expect(output.locations[1].dates[0].date.getTime()).to.equal(1444608000000);
      expect(output.locations[1].dates[0].count).to.equal(2);
      expect(output.locations[1].dates[0].name).to.equal('Mumbai, State of Maharashtra');

      expect(output.allLocations).to.deep.equal(output.locations);
      expect(output.otherLocations).to.deep.equal(output.locations);
      expect(output.dates).to.deep.equal([1444608000000, 1444521600000, 1444435200000, 1444608000000]);
    });

    test('drops timeline function given aggregations and location ID returns correct data', function() {
      var output = clientConfig.config.transforms.offer.createEventDropsTimeline(data, 'Brooklyn:New York:United States:-73.94958:40.6501');

      expect(output.locations.length).to.equal(1);
      expect(output.locations[0].count).to.equal(4);
      expect(output.locations[0].id).to.equal('Brooklyn:New York:United States:-73.94958:40.6501');
      expect(output.locations[0].latitude).to.equal('40.6501');
      expect(output.locations[0].longitude).to.equal('-73.94958');
      expect(output.locations[0].icon).to.equal('communication:location-on');
      expect(output.locations[0].link).to.equal('/location.html?id=Brooklyn:New York:United States:-73.94958:40.6501');
      expect(output.locations[0].name).to.equal('Brooklyn, New York');
      expect(output.locations[0].styleClass).to.equal('entity-location-font');
      expect(output.locations[0].text).to.equal('Brooklyn, New York');
      expect(output.locations[0].textAndCount).to.equal('Brooklyn, New York (4)');
      expect(output.locations[0].textAndCountry).to.equal('Brooklyn, New York, United States');
      expect(output.locations[0].type).to.equal('location');
      expect(output.locations[0].dates).to.be.an('Array');
      expect(output.locations[0].dates.length).to.equal(3);
      expect(output.locations[0].dates[0].date).to.be.a('Date');
      expect(output.locations[0].dates[0].date.getTime()).to.equal(1444435200000);
      expect(output.locations[0].dates[0].count).to.equal(1);
      expect(output.locations[0].dates[0].name).to.equal('Brooklyn, New York');
      expect(output.locations[0].dates[1].date).to.be.a('Date');
      expect(output.locations[0].dates[1].date.getTime()).to.equal(1444521600000);
      expect(output.locations[0].dates[1].count).to.equal(2);
      expect(output.locations[0].dates[1].name).to.equal('Brooklyn, New York');
      expect(output.locations[0].dates[2].date).to.be.a('Date');
      expect(output.locations[0].dates[2].date.getTime()).to.equal(1444608000000);
      expect(output.locations[0].dates[2].count).to.equal(1);
      expect(output.locations[0].dates[2].name).to.equal('Brooklyn, New York');

      expect(output.otherLocations[0].count).to.equal(2);
      expect(output.otherLocations[0].id).to.equal('Mumbai:State of Maharashtra:India:72.88261:19.07283');
      expect(output.otherLocations[0].latitude).to.equal('19.07283');
      expect(output.otherLocations[0].longitude).to.equal('72.88261');
      expect(output.otherLocations[0].icon).to.equal('communication:location-on');
      expect(output.otherLocations[0].link).to.equal('/location.html?id=Mumbai:State of Maharashtra:India:72.88261:19.07283');
      expect(output.otherLocations[0].name).to.equal('Mumbai, State of Maharashtra');
      expect(output.otherLocations[0].styleClass).to.equal('entity-location-font');
      expect(output.otherLocations[0].text).to.equal('Mumbai, State of Maharashtra');
      expect(output.otherLocations[0].textAndCount).to.equal('Mumbai, State of Maharashtra (2)');
      expect(output.otherLocations[0].textAndCountry).to.equal('Mumbai, State of Maharashtra, India');
      expect(output.otherLocations[0].type).to.equal('location');
      expect(output.otherLocations[0].dates).to.be.an('Array');
      expect(output.otherLocations[0].dates.length).to.equal(1);
      expect(output.otherLocations[0].dates[0].date).to.be.a('Date');
      expect(output.otherLocations[0].dates[0].date.getTime()).to.equal(1444608000000);
      expect(output.otherLocations[0].dates[0].count).to.equal(2);
      expect(output.otherLocations[0].dates[0].name).to.equal('Mumbai, State of Maharashtra');

      expect(output.allLocations.length).to.equal(2);
      expect(output.allLocations[0]).to.deep.equal(output.locations[0]);
      expect(output.allLocations[1]).to.deep.equal(output.otherLocations[0]);
      expect(output.dates).to.deep.equal([1444608000000, 1444521600000, 1444435200000]);
    });
  });

  suite('<client-config> offer tests for offer phones', function() {
    var clientConfig;
    /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
    var data = {
      aggregations: {
        phone: {
          phone: {
            buckets: [{
              doc_count: 10,
              key: '+1-9876543210',
            }, {
              doc_count: 1,
              key: '1234567890',
            }]
          }
        }
      }
    };
    /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with offer phones transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.offerPhones).to.be.a('Function');
    });

    test('offer phones function given empty input returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerPhones({});
      expect(output.title).to.deep.equal('No Telephone Numbers');
      expect(output.phone).to.deep.equal([]);
    });

    test('offer phones function given phone array returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerPhones(data);
      expect(output.title).to.equal('2 Telephone Numbers');
      expect(output.phone).to.deep.equal([{
        confidence: undefined,
        count: 10,
        id: '+1-9876543210',
        icon: 'communication:phone',
        link: '/phone.html?id=+1-9876543210',
        styleClass: 'entity-phone-font',
        text: '987-654-3210',
        type: 'phone'
      }, {
        confidence: undefined,
        count: 1,
        id: '1234567890',
        icon: 'communication:phone',
        link: '/phone.html?id=1234567890',
        styleClass: 'entity-phone-font',
        text: '123-456-7890',
        type: 'phone'
      }]);
    });

    test('offer phones function given phone array and ID to ignore returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerPhones(data, '+1-9876543210');
      expect(output.title).to.equal('1 Other Telephone Number');
      expect(output.phone).to.deep.equal([{
        confidence: undefined,
        count: 1,
        id: '1234567890',
        icon: 'communication:phone',
        link: '/phone.html?id=1234567890',
        styleClass: 'entity-phone-font',
        text: '123-456-7890',
        type: 'phone'
      }]);
    });
  });

  suite('<client-config> offer tests for offer emails', function() {
    var clientConfig;
    /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
    var data = {
      aggregations: {
        email: {
          email: {
            buckets: [{
              doc_count: 25,
              key: 'email@address.com'
            }, {
              doc_count: 5,
              key: 'email@gmail.com'
            }]
          }
        }
      }
    };
    /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with offer emails transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.offerEmails).to.be.a('Function');
    });

    test('offer emails function given empty input returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerEmails({});
      expect(output.title).to.deep.equal('No Email Addresses');
      expect(output.email).to.deep.equal([]);
    });

    test('offer emails function given email array returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerEmails(data);
      expect(output.title).to.equal('2 Email Addresses');
      expect(output.email).to.deep.equal([{
        confidence: undefined,
        count: 25,
        id: 'email@address.com',
        icon: 'communication:email',
        link: '/email.html?id=email%40address.com',
        styleClass: 'entity-email-font',
        text: 'email@address.com',
        type: 'email'
      }, {
        confidence: undefined,
        count: 5,
        id: 'email@gmail.com',
        icon: 'communication:email',
        link: '/email.html?id=email%40gmail.com',
        styleClass: 'entity-email-font',
        text: 'email@gmail.com',
        type: 'email'
      }]);
    });

    test('offer emails function given email array and ID to ignore returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerEmails(data, 'email@address.com');
      expect(output.title).to.equal('1 Other Email Address');
      expect(output.email).to.deep.equal([{
        confidence: undefined,
        count: 5,
        id: 'email@gmail.com',
        icon: 'communication:email',
        link: '/email.html?id=email%40gmail.com',
        styleClass: 'entity-email-font',
        text: 'email@gmail.com',
        type: 'email'
      }]);
    });
  });

  suite('<client-config> offer tests for offer locations title', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with offer locations title transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.offerLocationsTitle).to.be.a('Function');
    });

    test('offer locations title function given empty input returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerLocationsTitle([]);
      expect(output).to.deep.equal('No Locations');
    });

    test('offer locations title function given array returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerLocationsTitle([1, 2, 3]);
      expect(output).to.deep.equal('3 Locations');
    });
  });

  suite('<client-config> offer tests for offer locations', function() {
    var clientConfig;
    /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
    var data = {
      aggregations: {
        location: {
          location: {
            buckets: [{
              doc_count: 50,
              key: 'Atlanta:Georgia:United States:-84.38798:33.749'
            }, {
              doc_count: 10,
              key: 'Brooklyn:New York:United States:-73.94958:40.6501'
            }, {
              doc_count: 5,
              key: 'Houston:Texas:United States:-95.36327:29.76328'
            }]
          }
        }
      }
    };
    /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with offer locations transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.offerLocations).to.be.a('Function');
    });

    test('offer locations function given empty input returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerLocations({});
      expect(output.title).to.deep.equal('No Locations');
      expect(output.location).to.deep.equal([]);
    });

    test('offer locations function given location array and ID to ignore returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerLocations(data);
      expect(output.title).to.equal('3 Locations');
      expect(output.location).to.deep.equal([{
        confidence: undefined,
        count: 50,
        id: 'Atlanta:Georgia:United States:-84.38798:33.749',
        icon: 'communication:location-on',
        latitude: '33.749',
        longitude: '-84.38798',
        link: '/location.html?id=Atlanta:Georgia:United States:-84.38798:33.749',
        styleClass: 'entity-location-font',
        text: 'Atlanta, Georgia',
        textAndCount: 'Atlanta, Georgia (50)',
        textAndCountry: 'Atlanta, Georgia, United States',
        type: 'location'
      }, {
        confidence: undefined,
        count: 10,
        id: 'Brooklyn:New York:United States:-73.94958:40.6501',
        icon: 'communication:location-on',
        latitude: '40.6501',
        longitude: '-73.94958',
        link: '/location.html?id=Brooklyn:New York:United States:-73.94958:40.6501',
        styleClass: 'entity-location-font',
        text: 'Brooklyn, New York',
        textAndCount: 'Brooklyn, New York (10)',
        textAndCountry: 'Brooklyn, New York, United States',
        type: 'location'
      }, {
        confidence: undefined,
        count: 5,
        id: 'Houston:Texas:United States:-95.36327:29.76328',
        icon: 'communication:location-on',
        latitude: '29.76328',
        longitude: '-95.36327',
        link: '/location.html?id=Houston:Texas:United States:-95.36327:29.76328',
        styleClass: 'entity-location-font',
        text: 'Houston, Texas',
        textAndCount: 'Houston, Texas (5)',
        textAndCountry: 'Houston, Texas, United States',
        type: 'location'
      }]);
    });
  });

  suite('<client-config> offer tests for offer provider attributes', function() {
    var clientConfig;
    /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
    var data = {
      aggregations: {
        attribute: {
          attribute: {
            buckets: [{
              doc_count: 50,
              key: 'blonde'
            }, {
              doc_count: 10,
              key: 'brunette'
            }, {
              doc_count: 5,
              key: 'auburn'
            }]
          }
        }
      }
    };
    /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with offer provider attributes transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.offerProviderAttributes).to.be.a('Function');
    });

    test('offer provider attributes function given empty input returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerProviderAttributes({});
      expect(output.attribute).to.deep.equal([]);
    });

    test('offer provider attributes function given attribute array and ID to ignore returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerProviderAttributes(data);
      expect(output.attribute).to.deep.equal([{
        confidence: undefined,
        count: 50,
        id: 'blonde',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'blonde',
        type: 'provider'
      }, {
        confidence: undefined,
        count: 10,
        id: 'brunette',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'brunette',
        type: 'provider'
      }, {
        confidence: undefined,
        count: 5,
        id: 'auburn',
        icon: 'icons:account-circle',
        styleClass: 'entity-provider-font',
        text: 'auburn',
        type: 'provider'
      }]);
    });
  });

  suite('<client-config> offer tests for offer publishers', function() {
    var clientConfig;
    /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
    var data = {
      aggregations: {
        publisher: {
          publisher: {
            buckets: [{
              doc_count: 50,
              key: 'google.com'
            }, {
              doc_count: 10,
              key: 'bing.com'
            }, {
              doc_count: 5,
              key: 'yahoo.com'
            }]
          }
        }
      }
    };
    /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with offer publishers transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.offerPublishers).to.be.a('Function');
    });

    test('offer publishers function given empty input returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerPublishers({});
      expect(output.title).to.deep.equal('No Websites');
      expect(output.publisher).to.deep.equal([]);
    });

    test('offer publishers function given publisher array returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerPublishers(data);
      expect(output.title).to.equal('3 Websites');
      expect(output.publisher).to.deep.equal([{
        count: 50,
        id: 'google.com',
        icon: 'av:web',
        styleClass: 'entity-webpage-font',
        text: 'google.com',
        type: 'webpage'
      }, {
        count: 10,
        id: 'bing.com',
        icon: 'av:web',
        styleClass: 'entity-webpage-font',
        text: 'bing.com',
        type: 'webpage'
      }, {
        count: 5,
        id: 'yahoo.com',
        icon: 'av:web',
        styleClass: 'entity-webpage-font',
        text: 'yahoo.com',
        type: 'webpage'
      }]);
    });
  });

  suite('<client-config> offer tests for offer social media IDs', function() {
    var clientConfig;
    /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
    var data = {
      aggregations: {
        social: {
          social: {
            buckets: [{
              doc_count: 50,
              key: 'twitter user1'
            }, {
              doc_count: 20,
              key: 'twitter user2'
            }, {
              doc_count: 10,
              key: 'twitter user3'
            }, {
              doc_count: 5,
              key: 'instagram user1'
            }, {
              doc_count: 1,
              key: 'user1'
            }]
          }
        }
      }
    };
    /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with offer social IDs transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.offerSocialIds).to.be.a('Function');
    });

    test('offer social IDs function given empty input returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerSocialIds({});
      expect(output.title).to.deep.equal('No Social Media IDs');
      expect(output.social).to.deep.equal([]);
    });

    test('offer social IDs function given social array returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerSocialIds(data);
      expect(output.title).to.equal('5 Social Media IDs');
      expect(output.social).to.deep.equal([{
        confidence: undefined,
        count: 50,
        id: 'user1',
        icon: 'social:public',
        styleClass: 'entity-social-font',
        text: 'twitter user1',
        type: 'social'
      }, {
        confidence: undefined,
        count: 20,
        id: 'user2',
        icon: 'social:public',
        styleClass: 'entity-social-font',
        text: 'twitter user2',
        type: 'social'
      }, {
        confidence: undefined,
        count: 10,
        id: 'user3',
        icon: 'social:public',
        styleClass: 'entity-social-font',
        text: 'twitter user3',
        type: 'social'
      }, {
        confidence: undefined,
        count: 5,
        id: 'user1',
        icon: 'social:public',
        styleClass: 'entity-social-font',
        text: 'instagram user1',
        type: 'social'
      }, {
        confidence: undefined,
        count: 1,
        id: 'user1',
        icon: 'social:public',
        styleClass: 'entity-social-font',
        text: 'user1',
        type: 'social'
      }]);
    });
  });

  suite('<client-config> offer tests for offer review IDs', function() {
    var clientConfig;
    /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
    var data = {
      aggregations: {
        review: {
          review: {
            buckets: [{
              doc_count: 50,
              key: 'review_id_1'
            }, {
              doc_count: 10,
              key: 'review id 2'
            }, {
              doc_count: 5,
              key: '123456'
            }]
          }
        }
      }
    };
    /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with offer review IDs transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.offerReviewIds).to.be.a('Function');
    });

    test('offer review IDs function given empty input returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerReviewIds({});
      expect(output.title).to.deep.equal('No Review IDs');
      expect(output.review).to.deep.equal([]);
    });

    test('offer review IDs function given review array returns correct array', function() {
      var output = clientConfig.config.transforms.offer.offerReviewIds(data);
      expect(output.title).to.equal('3 Review IDs');
      expect(output.review).to.deep.equal([{
        confidence: undefined,
        count: 50,
        id: 'review_id_1',
        icon: 'icons:thumbs-up-down',
        styleClass: 'entity-review-font',
        text: 'review_id_1',
        type: 'review'
      }, {
        confidence: undefined,
        count: 10,
        id: 'review id 2',
        icon: 'icons:thumbs-up-down',
        styleClass: 'entity-review-font',
        text: 'review id 2',
        type: 'review'
      }, {
        confidence: undefined,
        count: 5,
        id: '123456',
        icon: 'icons:thumbs-up-down',
        styleClass: 'entity-review-font',
        text: '123456',
        type: 'review'
      }]);
    });
  });

  suite('<client-config> offer tests for removeNoteFromLocationTimeline transform', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with remove note transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.removeNoteFromLocationTimeline).to.be.a('Function');
    });

    test('results are correct for single removal', function() {
      var output = clientConfig.config.transforms.offer.removeNoteFromLocationTimeline('id1', [{
        locations: [{
          notes: [{
            name: 'Things',
            data: [{
              id: 'id1'
            }, {
              id: 'id2'
            }]
          }]
        }]
      }]);

      expect(output).to.exist;
      expect(output).to.be.an('Array');
      expect(output).to.deep.equal([{
        locations: [{
          notes: [{
            name: 'Other Things',
            data: [{
              id: 'id2'
            }]
          }]
        }]
      }]);
    });

    test('results are correct for single removal causing note removal', function() {
      var output = clientConfig.config.transforms.offer.removeNoteFromLocationTimeline('id1', [{
        locations: [{
          notes: [{
            name: 'Things',
            data: [{
              id: 'id1'
            }]
          }]
        }]
      }]);

      expect(output).to.exist;
      expect(output).to.be.an('Array');
      expect(output).to.deep.equal([{
        locations: [{
          notes: []
        }]
      }]);
    });

    test('results are correct for multiple removals', function() {
      var output = clientConfig.config.transforms.offer.removeNoteFromLocationTimeline('id1', [{
        locations: [{
          notes: [{
            name: 'Things1',
            data: [{
              id: 'id1'
            }, {
              id: 'id2'
            }]
          }]
        }, {
          notes: [{
            name: 'Things2',
            data: [{
              id: 'id1'
            }, {
              id: 'id2'
            }]
          }, {
            name: 'Things3',
            data: [{
              id: 'id1'
            }, {
              id: 'id2'
            }]
          }]
        }]
      }, {
        locations: [{
          notes: [{
            name: 'Things4',
            data: [{
              id: 'id1'
            }, {
              id: 'id2'
            }]
          }]
        }]
      }]);

      expect(output).to.exist;
      expect(output).to.be.an('Array');
      expect(output).to.deep.equal([{
        locations: [{
          notes: [{
            name: 'Other Things1',
            data: [{
              id: 'id2'
            }]
          }]
        }, {
          notes: [{
            name: 'Other Things2',
            data: [{
              id: 'id2'
            }]
          }, {
            name: 'Other Things3',
            data: [{
              id: 'id2'
            }]
          }]
        }]
      }, {
        locations: [{
          notes: [{
            name: 'Other Things4',
            data: [{
              id: 'id2'
            }]
          }]
        }]
      }]);
    });

    test('results are correct for unknown item', function() {
      var output = clientConfig.config.transforms.offer.removeNoteFromLocationTimeline('id2', [{
        locations: [{
          notes: [{
            data: [{
              id: 'id1'
            }]
          }]
        }]
      }]);

      expect(output).to.exist;
      expect(output).to.be.an('Array');
      expect(output).to.deep.equal([{
        locations: [{
          notes: [{
            data: [{
              id: 'id1'
            }]
          }]
        }]
      }]);
    });

    test('results are correct for empty array', function() {
      var output = clientConfig.config.transforms.offer.removeNoteFromLocationTimeline('id1', []);

      expect(output).to.exist;
      expect(output).to.be.an('Array');
      expect(output).to.deep.equal([]);
    });
  });

  suite('<client-config> offer tests for the location page map data', function() {
    var clientConfig;
    var data = [{
      id: 'Atlanta:Georgia:United States:-84.38798:33.749'
    }, {
      id: 'Brooklyn:New York:United States:-73.94958:40.6501'
    }, {
      id: 'Houston:Texas:United States:-95.36327:29.76328'
    }];

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with map locations transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.locationPageMap).to.be.a('Function');
    });

    test('defines locations for map location aggregation buckets', function() {
      var output = clientConfig.config.transforms.offer.locationPageMap('Atlanta:Georgia:United States:-84.38798:33.749', data);
      expect(output).to.deep.equal([{
        iconId: 'mainLocation',
        id: 'Atlanta:Georgia:United States:-84.38798:33.749'
      }, {
        id: 'Brooklyn:New York:United States:-73.94958:40.6501'
      }, {
        id: 'Houston:Texas:United States:-95.36327:29.76328'
      }]);
    });

    test('if the first location argument is not yet defined, transform returns undefined', function() {
      var output = clientConfig.config.transforms.offer.locationPageMap(undefined, data);
      expect(output).to.be.undefined;
    });

    test('if aggregation argument is not yet defined, transform returns undefined', function() {
      var output = clientConfig.config.transforms.offer.locationPageMap('Atlanta:Georgia:United States:-84.38798:33.749', undefined);
      expect(output).to.be.undefined;
    });
  });

  suite('<client-config> offer tests for location timeline (itinerary)', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with location timeline transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.locationTimeline).to.be.a('Function');
    });

    test('returns array sorted by date', function() {
      var output = clientConfig.config.transforms.offer.locationTimeline(AD_BAR_CHART_DATA);

      expect(output.dates).to.deep.equal([{
        date: 'Oct 20, 2015',
        icon: 'icons:date-range',
        styleClass: 'entity-date-font',
        subtitle: 'Atlanta, Georgia (1) and 1 more',
        locations: [{
          confidence: undefined,
          count: 1,
          id: 'Atlanta:Georgia:United States:-84.38798:33.749',
          icon: 'communication:location-on',
          latitude: '33.749',
          longitude: '-84.38798',
          link: '/location.html?id=Atlanta:Georgia:United States:-84.38798:33.749',
          styleClass: 'entity-location-font',
          text: 'Atlanta, Georgia',
          textAndCount: 'Atlanta, Georgia (1)',
          textAndCountry: 'Atlanta, Georgia, United States',
          type: 'location',
          notes: [{
            name: 'Websites',
            data: [{
              count: 1,
              id: 'google.com',
              icon: 'av:web',
              styleClass: 'entity-webpage-font',
              text: 'google.com',
              type: 'webpage'
            }]
          }, {
            name: 'Telephone Numbers',
            data: [{
              confidence: undefined,
              count: 1,
              id: '+1-1234567890',
              icon: 'communication:phone',
              link: '/phone.html?id=+1-1234567890',
              styleClass: 'entity-phone-font',
              text: '123-456-7890',
              type: 'phone'
            }]
          }, {
            name: 'Email Addresses',
            data: [{
              confidence: undefined,
              count: 1,
              id: 'abc123@gmail.com',
              icon: 'communication:email',
              link: '/email.html?id=abc123%40gmail.com',
              styleClass: 'entity-email-font',
              text: 'abc123@gmail.com',
              type: 'email'
            }]
          }]
        }, {
          confidence: undefined,
          count: 1,
          id: 'Brooklyn:New York:United States:-73.94958:40.6501',
          icon: 'communication:location-on',
          latitude: '40.6501',
          longitude: '-73.94958',
          link: '/location.html?id=Brooklyn:New York:United States:-73.94958:40.6501',
          styleClass: 'entity-location-font',
          text: 'Brooklyn, New York',
          textAndCount: 'Brooklyn, New York (1)',
          textAndCountry: 'Brooklyn, New York, United States',
          type: 'location',
          notes: [{
            name: 'Websites',
            data: [{
              count: 1,
              id: 'yahoo.com',
              icon: 'av:web',
              styleClass: 'entity-webpage-font',
              text: 'yahoo.com',
              type: 'webpage'
            }]
          }, {
            name: 'Telephone Numbers',
            data: [{
              confidence: undefined,
              count: 1,
              id: '+1-9876543210',
              icon: 'communication:phone',
              link: '/phone.html?id=+1-9876543210',
              styleClass: 'entity-phone-font',
              text: '987-654-3210',
              type: 'phone'
            }]
          }, {
            name: 'Email Addresses',
            data: [{
              confidence: undefined,
              count: 1,
              id: 'xyz123@yahoo.com',
              icon: 'communication:email',
              link: '/email.html?id=xyz123%40yahoo.com',
              styleClass: 'entity-email-font',
              text: 'xyz123@yahoo.com',
              type: 'email'
            }]
          }]
        }]
      }]);
    });

    test('returns array for dates with no locations', function() {
      /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
      var output = clientConfig.config.transforms.offer.locationTimeline({
        aggregations: {
          dates: {
            dates: {
              buckets: [{
                doc_count: 10,
                key: 1445299200000,
                locations: {
                  buckets: []
                }
              }]
            }
          }
        }
      });
      /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

      assert.isArray(output.dates);
      assert.equal(output.dates.length, 1);
      assert.equal(output.dates[0].subtitle, 'Unknown Location(s) (10)');
      assert.equal(output.dates[0].date, 'Oct 20, 2015');
      assert.isArray(output.dates[0].locations);
      assert.equal(output.dates[0].locations.length, 1);
      assert.equal(output.dates[0].locations[0].text, 'Unknown Location(s)');
      assert.equal(output.dates[0].locations[0].count, 10);
    });

    test('returns empty array for dates with no doc count', function() {
      /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
      var output = clientConfig.config.transforms.offer.locationTimeline({
        aggregations: {
          dates: {
            dates: {
              buckets: [{
                doc_count: 0,
                key: 1445299200000,
                locations: {
                  buckets: []
                }
              }]
            }
          }
        }
      });
      /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

      assert.isArray(output.dates);
      assert.equal(output.dates.length, 0);
    });
  });

  suite('<client-config> offer tests for CSV export data', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with CSV export data transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.createExportDataForCsv).to.be.a('Function');
    });

    test('CSV export data function given empty input returns correct array', function() {
      var output = clientConfig.config.transforms.offer.createExportDataForCsv([]);
      expect(output).to.be.an('Array');
      expect(output).to.deep.equal([['ad url', 'dig url', 'title', 'high risk', 'date', 'locations', 'telephone numbers', 'email addresses', 'social media ids', 'review ids', 'images', 'description']]);
    });

    test('CSV export data function given results array returns correct array', function() {
      var output = clientConfig.config.transforms.offer.createExportDataForCsv([{
        url: 'url',
        link: 'link',
        title: 'title',
        description: 'A quick brown fox\njumped over the lazy dog.',
        highRisk: false,
        date: {
          text: 'today'
        },
        locations: [{
          textAndCountry: 'location'
        }],
        phones: [{
          text: 'phone'
        }],
        emails: [{
          text: 'email'
        }],
        socialIds: [{
          text: 'socialId'
        }],
        reviewIds: [{
          text: 'reviewId'
        }],
        images: [{
          source: 'image'
        }]
      }]);
      expect(output).to.be.an('Array');
      expect(output.length).to.equal(2);
      expect(output[0]).to.deep.equal(['ad url', 'dig url', 'title', 'high risk', 'date', 'locations', 'telephone numbers', 'email addresses', 'social media ids', 'review ids', 'images', 'description']);
      expect(output[1][0]).to.equal('url');
      expect(output[1][1]).to.be.a('String');
      expect(output[1][2]).to.equal('title');
      expect(output[1][3]).to.equal('no');
      expect(output[1][4]).to.equal('today');
      expect(output[1][5]).to.equal('location');
      expect(output[1][6]).to.equal('phone');
      expect(output[1][7]).to.equal('email');
      expect(output[1][8]).to.equal('socialId');
      expect(output[1][9]).to.equal('reviewId');
      expect(output[1][10]).to.equal('image');
      expect(output[1][11]).to.equal('A quick brown fox jumped over the lazy dog.');
    });

    test('CSV export data function given results array with multiple emails, images, locations, and phones returns correct array', function() {
      var output = clientConfig.config.transforms.offer.createExportDataForCsv([{
        url: 'url',
        link: 'link',
        title: 'title',
        description: 'A quick brown fox\njumped over the lazy dog.',
        highRisk: true,
        date: {
          text: 'today'
        },
        locations: [{
          textAndCountry: 'location1'
        }, {
          textAndCountry: 'location2'
        }, {
          textAndCountry: 'location3'
        }],
        phones: [{
          text: 'phone1'
        }, {
          text: 'phone2'
        }, {
          text: 'phone3'
        }],
        emails: [{
          text: 'email1'
        }, {
          text: 'email2'
        }, {
          text: 'email3'
        }],
        socialIds: [{
          text: 'socialId1'
        }, {
          text: 'socialId2'
        }, {
          text: 'socialId3'
        }],
        reviewIds: [{
          text: 'reviewId1'
        }, {
          text: 'reviewId2'
        }, {
          text: 'reviewId3'
        }],
        images: [{
          source: 'image1'
        }, {
          source: 'image2'
        }, {
          source: 'image3'
        }]
      }]);
      expect(output).to.be.an('Array');
      expect(output.length).to.equal(2);
      expect(output[0]).to.deep.equal(['ad url', 'dig url', 'title', 'high risk', 'date', 'locations', 'telephone numbers', 'email addresses', 'social media ids', 'review ids', 'images', 'description']);
      expect(output[1][0]).to.equal('url');
      expect(output[1][1]).to.be.a('String');
      expect(output[1][2]).to.equal('title');
      expect(output[1][3]).to.equal('yes');
      expect(output[1][4]).to.equal('today');
      expect(output[1][5]).to.equal('location1; location2; location3');
      expect(output[1][6]).to.equal('phone1; phone2; phone3');
      expect(output[1][7]).to.equal('email1; email2; email3');
      expect(output[1][8]).to.equal('socialId1; socialId2; socialId3');
      expect(output[1][9]).to.equal('reviewId1; reviewId2; reviewId3');
      expect(output[1][10]).to.equal('image1; image2; image3');
      expect(output[1][11]).to.equal('A quick brown fox jumped over the lazy dog.');
    });
  });

  suite('<client-config> offer tests for PDF export data', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with PDF export data transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.createExportDataForPdf).to.be.a('Function');
    });

    test('PDF export data function given empty input returns correct array', function() {
      var output = clientConfig.config.transforms.offer.createExportDataForPdf([]);
      expect(output).to.be.an('Array');
      expect(output).to.deep.equal([]);
    });

    test('PDF export data function given results array returns correct array', function() {
      var output = clientConfig.config.transforms.offer.createExportDataForPdf([{
        url: 'url',
        link: 'link',
        title: 'title',
        highRisk: false,
        date: {
          text: 'today'
        },
        locations: [{
          textAndCountry: 'location'
        }],
        phones: [{
          text: 'phone'
        }],
        emails: [{
          text: 'email'
        }],
        socialIds: [{
          text: 'socialId'
        }],
        reviewIds: [{
          text: 'reviewId'
        }],
        images: [{
          source: 'image'
        }],
        description: 'A quick brown fox\njumped over the lazy dog.'
      }]);
      expect(output).to.be.an('Array');
      expect(output.length).to.equal(1);
      expect(output[0].images).to.be.an('Array');
      expect(output[0].images.length).to.equal(1);
      expect(output[0].images).deep.equal([{
        id: 'image1',
        source: 'image',
        text: 'image'
      }]);
      expect(output[0].paragraphs).to.be.an('Array');
      expect(output[0].paragraphs.length).to.equal(11);
      expect(output[0].paragraphs[0]).to.deep.equal({
        big: true,
        label: 'title',
        value: ''
      });
      expect(output[0].paragraphs[1]).to.deep.equal({
        label: 'High Risk:  ',
        value: 'No'
      });
      expect(output[0].paragraphs[2]).to.deep.equal({
        label: 'Posting Date:  ',
        value: 'today'
      });
      expect(output[0].paragraphs[3]).to.deep.equal({
        label: 'Locations:  ',
        value: 'location'
      });
      expect(output[0].paragraphs[4]).to.deep.equal({
        label: 'Telephone Numbers:  ',
        value: 'phone'
      });
      expect(output[0].paragraphs[5]).to.deep.equal({
        label: 'Email Addresses:  ',
        value: 'email'
      });
      expect(output[0].paragraphs[6]).to.deep.equal({
        label: 'Social Media IDs:  ',
        value: 'socialId'
      });
      expect(output[0].paragraphs[7]).to.deep.equal({
        label: 'Review IDs:  ',
        value: 'reviewId'
      });
      expect(output[0].paragraphs[8]).to.deep.equal({
        label: 'Description:  ',
        value: 'A quick brown fox jumped over the lazy dog.'
      });
      expect(output[0].paragraphs[9]).to.deep.equal({
        label: 'URL:  ',
        value: 'url'
      });
      expect(output[0].paragraphs[10]).to.be.an('Object');
      expect(output[0].paragraphs[10].label).to.equal('DIG URL:  ');
      expect(output[0].paragraphs[10].value).to.be.a('String');
    });

    test('PDF export data function given results array with multiple emails, images, locations, phones, review IDs, and social media IDs returns correct array', function() {
      var output = clientConfig.config.transforms.offer.createExportDataForPdf([{
        url: 'url',
        link: 'link',
        title: 'title',
        highRisk: true,
        date: {
          text: 'today'
        },
        locations: [{
          textAndCountry: 'location1'
        }, {
          textAndCountry: 'location2'
        }, {
          textAndCountry: 'location3'
        }],
        phones: [{
          text: 'phone1'
        }, {
          text: 'phone2'
        }, {
          text: 'phone3'
        }],
        emails: [{
          text: 'email1'
        }, {
          text: 'email2'
        }, {
          text: 'email3'
        }],
        socialIds: [{
          text: 'socialId1'
        }, {
          text: 'socialId2'
        }, {
          text: 'socialId3'
        }],
        reviewIds: [{
          text: 'reviewId1'
        }, {
          text: 'reviewId2'
        }, {
          text: 'reviewId3'
        }],
        images: [{
          source: 'image1'
        }, {
          source: 'image2'
        }, {
          source: 'image3'
        }],
        description: 'A quick brown fox\njumped over the lazy dog.'
      }]);
      expect(output).to.be.an('Array');
      expect(output.length).to.equal(1);
      expect(output[0].images).to.be.an('Array');
      expect(output[0].images.length).to.equal(3);
      expect(output[0].images).deep.equal([{
        id: 'image1',
        source: 'image1',
        text: 'image1'
      }, {
        id: 'image2',
        source: 'image2',
        text: 'image2'
      }, {
        id: 'image3',
        source: 'image3',
        text: 'image3'
      }]);
      expect(output[0].paragraphs).to.be.an('Array');
      expect(output[0].paragraphs.length).to.equal(11);
      expect(output[0].paragraphs[0]).to.deep.equal({
        big: true,
        label: 'title',
        value: ''
      });
      expect(output[0].paragraphs[1]).to.deep.equal({
        label: 'High Risk:  ',
        value: 'Yes'
      });
      expect(output[0].paragraphs[2]).to.deep.equal({
        label: 'Posting Date:  ',
        value: 'today'
      });
      expect(output[0].paragraphs[3]).to.deep.equal({
        label: 'Locations:  ',
        value: 'location1, location2, location3'
      });
      expect(output[0].paragraphs[4]).to.deep.equal({
        label: 'Telephone Numbers:  ',
        value: 'phone1, phone2, phone3'
      });
      expect(output[0].paragraphs[5]).to.deep.equal({
        label: 'Email Addresses:  ',
        value: 'email1, email2, email3'
      });
      expect(output[0].paragraphs[6]).to.deep.equal({
        label: 'Social Media IDs:  ',
        value: 'socialId1, socialId2, socialId3'
      });
      expect(output[0].paragraphs[7]).to.deep.equal({
        label: 'Review IDs:  ',
        value: 'reviewId1, reviewId2, reviewId3'
      });
      expect(output[0].paragraphs[8]).to.deep.equal({
        label: 'Description:  ',
        value: 'A quick brown fox jumped over the lazy dog.'
      });
      expect(output[0].paragraphs[9]).to.deep.equal({
        label: 'URL:  ',
        value: 'url'
      });
      expect(output[0].paragraphs[10]).to.be.an('Object');
      expect(output[0].paragraphs[10].label).to.equal('DIG URL:  ');
      expect(output[0].paragraphs[10].value).to.be.a('String');
    });
  });

  suite('<client-config> offer revisions tests', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
    });

    test('defines config object with revisions transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig.config).to.be.an('Object');
      expect(clientConfig.config.transforms).to.be.an('Object');
      expect(clientConfig.config.transforms.offer).to.be.an('Object');
      expect(clientConfig.config.transforms.offer.revisions).to.be.an('Function');
    });

    test('defines revisions for multiple dates', function() {
      /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
      var output = clientConfig.config.transforms.offer.revisions({
        aggregations: {
          revisions: {
            doc_count: 15,
            revisions: {
              buckets: [{
                key_as_string: '2016-01-01T00:00:00.000Z',
                doc_count: 10
              }, {
                key_as_string: '2016-01-02T00:00:00.000Z',
                doc_count: 5
              }]
            }
          }
        }
      });
      /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

      expect(output).to.deep.equal([{
        date: 'Jan 1, 2016',
        list: [{
          count: 10,
          label: 'Revision on Jan 1, 2016'
        }]
      }, {
        date: 'Jan 2, 2016',
        list: [{
          count: 5,
          label: 'Revision on Jan 2, 2016'
        }]
      }]);
    });

    test('defines revisions for single date with multiple revisions', function() {
      /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
      var output = clientConfig.config.transforms.offer.revisions({
        aggregations: {
          revisions: {
            doc_count: 5,
            revisions: {
              buckets: [{
                key_as_string: '2016-01-01T00:00:00.000Z',
                doc_count: 5
              }]
            }
          }
        }
      });
      /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

      expect(output).to.deep.equal([{
        date: 'Jan 1, 2016',
        list: [{
          count: 5,
          label: 'Revision on Jan 1, 2016'
        }]
      }]);
    });

    test('defines revisions for a single date with single revision as an empty array', function() {
      /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
      var output = clientConfig.config.transforms.offer.revisions({
        aggregations: {
          revisions: {
            doc_count: 1,
            revisions: {
              buckets: [{
                key_as_string: '2016-01-01T00:00:00.000Z',
                doc_count: 1
              }]
            }
          }
        }
      });
      /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

      expect(output).to.deep.equal([]);
    });
  });
</script>
</body>
</html>
